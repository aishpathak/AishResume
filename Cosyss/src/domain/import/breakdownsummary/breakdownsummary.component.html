<form [formGroup]="searchForm">
  <ngc-titlebar title='import.breakdown.summary' (cancel)="onBack($event)" (print)="onPrint()" (save)="onSave()"
    [disableSave]="disableSaveFlag" [disablePrint]="printFlag==false">
  </ngc-titlebar>
  <ngc-container type="section">
    <ngc-row>
      <ngc-column [column]="1.5">
        <ngc-label label='import.flight'></ngc-label>
        <div>
          <ngc-flightkeyinput accessEnableOn="r" formControlName="flightNumber" required="true"></ngc-flightkeyinput>
        </div>
      </ngc-column>
      <ngc-column [column]="1.5">
        <ngc-label label='agent.createRoutingDate'></ngc-label>
        <div>
          <ngc-datetimeinput accessEnableOn="r" formControlName="flightDate" required="true"></ngc-datetimeinput>
        </div>
      </ngc-column>
      <ngc-column [column]="1.5">
        <ngc-label label='uld.uld.number'></ngc-label>
        <div>
          <ngc-uldinput formControlName="uldNumber"></ngc-uldinput>
        </div>
      </ngc-column>
      <ngc-column [column]="1.5">
        <ngc-label label=''></ngc-label>
        <div>
          <ngc-button label='g.search' accessEnableOn="r" (click)="onSearch()" iconType="search" #searchbutton>
          </ngc-button>
          <!-- <ngc-button value="Print Report" (click)="onPrint()" *ngIf="isFlightInformation"></ngc-button> -->
        </div>
      </ngc-column>
      <ngc-column [column]="1" *ngIf="isFlightInformation">
        <ngc-label label="g.printer"></ngc-label>
        <div>
          <ngc-printer [width]='200' formControlName="printerName"></ngc-printer>
        </div>
      </ngc-column>
    </ngc-row>
    <ngc-row>
      <ngc-column></ngc-column>
    </ngc-row>
    <ngc-row *ngIf="isFlightInformation">
      <ngc-column column="1.5" [grid24]="true">
        <ngc-label label='import.flight'></ngc-label>
        <div>
          <ngc-display formControlName="flightNumber"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column column="1.5" [grid24]="true">
        <ngc-label label='agent.createRoutingDate'></ngc-label>
        <div>
          <ngc-display formControlName="flightDate" [onlyDate]="true"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column column="1.5" [grid24]="true">
        <ngc-label label='import.sta'></ngc-label>
        <div>
          <ngc-display formControlName="sta"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column column="1.5" [grid24]="true">
        <ngc-label label='import.ata'></ngc-label>
        <div>
          <ngc-display formControlName="ata"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column [column]="1.5">
        <ngc-label label='import.first.uld.tow.in.time'></ngc-label>
        <div>
          <ngc-display formControlName="firstUldTowInTime"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column [column]="1.5">
        <ngc-label label='import.last.uld.tow.in.time'></ngc-label>
        <div>
          <ngc-display formControlName="lastUldTowInTime"></ngc-display>

        </div>
      </ngc-column>

      <ngc-column [column]="2">
        <ngc-label label='import.breakdowncompletion.date'></ngc-label>
        <div>
          <ngc-display formControlName="breakdownCompletionDataTime"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column [column]="1.5">
        <ngc-label label='import.flight.completion.date'></ngc-label>
        <div>
          <ngc-display formControlName="flightCompletionDataTime"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column [column]="1">
        <ngc-label label='import.delay.in.minutes'></ngc-label>
        <div>
          <ngc-display formControlName="delayInMinutes"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column [column]="1">
        <ngc-label label='import.flight.closed'></ngc-label>
        <div>
          <ngc-display formControlName="flightClosedAt"></ngc-display>/
          <ngc-display formControlName="fightClosedBy"></ngc-display>
        </div>
      </ngc-column>
    </ngc-row>
  </ngc-container>
  <ngc-container type="section" *ngIf="isFlightInformation">
    <ngc-row>
      <ngc-column [column]="1">
        <ngc-label label='import.duty.manager'></ngc-label>
        <div>
          <ngc-display formControlName="dutyManager"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column [column]="1">
        <ngc-label label='import.checker'></ngc-label>
        <div>
          <ngc-display formControlName="checker"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column [column]="2">
        <ngc-label label='import.breakdown.staff.group'></ngc-label>
        <div>
          <ngc-display formControlName="breakDownStaffGroup"></ngc-display>
        </div>
      </ngc-column>
      <!-- <ngc-column [column]="2" align="center">
        <ngc-label label='Tonnage Break Down By SP'></ngc-label>
        <div>
          <ngc-weightdisplay formControlName="tonnageBreakDownBySp"></ngc-weightdisplay>
        </div>
      </ngc-column>
      <ngc-column [column]="2" align="center">
        <ngc-label label='Tonnage Break Down By SATS'></ngc-label>
        <div>
          <ngc-weightdisplay formControlName="tonnageBreakDownBySats"></ngc-weightdisplay>
        </div>
      </ngc-column>-->
      <ngc-column [column]="2" align="center">
        <ngc-label label='import.breakdown.total.tonnage.by.flight'></ngc-label>
        <div>
          <ngc-weightdisplay formControlName="totalTonnageByFlight"></ngc-weightdisplay>
        </div>
      </ngc-column>
      <ngc-column [column]="2" align="center">
        <ngc-label label='imort.breakdown.tonnage.in.uld'></ngc-label>
        <div>
          <ngc-weightdisplay formControlName="tonnageULDWeight"></ngc-weightdisplay>
        </div>
      </ngc-column>
      <ngc-column [column]="2" align="center">
        <ngc-label label='import.breakdown.tonnage.in.bulk'></ngc-label>
        <div>
          <ngc-weightdisplay formControlName="tonnageBulkWeight"></ngc-weightdisplay>
        </div>
      </ngc-column>
      <ngc-column [column]="2" align="center">
        <ngc-label label='import.breakdown.tonnage.by.sp'></ngc-label>
        <div>
          <ngc-weightdisplay formControlName="tonnageBreakDownBySp"></ngc-weightdisplay>
        </div>
      </ngc-column>
      <ngc-column [column]="2" align="left">
        <ngc-label label='import.breakdown.tonnage'></ngc-label>
        <div>
          <ngc-weightdisplay formControlName="tonnageBreakDownBySats"></ngc-weightdisplay>
        </div>
      </ngc-column>

    </ngc-row>

    <ngc-row>

    </ngc-row>
    <ngc-row>
      <ngc-column>
        <ngc-table>
          <thead>
            <tr>
              <th rowspan="2" [width]="400">
                <ngc-label label="uld.uld.number"></ngc-label>
              </th>
              <th rowspan="2" [width]="400">
                <ngc-label label="imp.handlingMode"></ngc-label>
              </th>
              <th rowspan="2" [width]="400">
                <ngc-label label="import.manifested.weight.br"></ngc-label>
              </th>
              <th rowspan="2" [width]="400">
                <ngc-label label="import.tonnage.breakdown.sp.br"></ngc-label>
              </th>
              <th rowspan="2" [width]="200" entityAttribute="Imp.BdSummary.BySats">
                <ngc-label label="import.tonnage.breakdown.tenant.br"></ngc-label>
              </th>
              <th rowspan="2" [width]="400">
                <ngc-label label="import.difference"></ngc-label>
              </th>
              <th rowspan="2" [width]="400">
                <ngc-label label="import.bd.staff"></ngc-label>
              </th>
              <th rowspan="2" [width]="400" entityAttribute="Imp.BdSummary.BySats">
                <ngc-label label="import.breakdown.tenant"></ngc-label>
              </th>
              <th rowspan="2" [width]="400">
                <ngc-label label="import.breakdown.start.date"></ngc-label>
              </th>
              <th rowspan="2" [width]="400">
                <ngc-label label="import.breakdown.end.date"></ngc-label>
              </th>
              <th rowspan="2" [width]="400">
                <ngc-label label="import.beakdown.service.contractor"></ngc-label>
              </th>
              <th rowspan="2" [width]="400" feature="Imp.Ramp.WhDestination">
                <ngc-label label="import.whse.dest"></ngc-label>
              </th>
              <th rowspan="2" [width]="400" feature="Imp.Ramp.ActualLocation">
                <ngc-label label="import.location"></ngc-label>
              </th>
              <th rowspan="2" [width]="400">
                <ngc-label label="import.bd.pcs.wt"></ngc-label>
              </th>
              <th rowspan="2" [width]="400">
                <ngc-label entityAttribute="Imp.Uld.Damage"></ngc-label>
              </th>
            </tr>
          </thead>
          <tbody formArrayName="uldInfo">
            <ng-container *ngFor="let item of searchForm.controls.uldInfo.controls; let index=index"
              [formGroupName]="index">
              <tr>
                <td align="center">
                  <ngc-display formControlName="uldNumber"></ngc-display>
                </td>
                <td align="center">
                  <ngc-display formControlName="handlingMode"></ngc-display>
                </td>
                <td align="center">
                  <ngc-weightdisplay formControlName="manifestedWeight"></ngc-weightdisplay>
                </td>
                <td align="center">
                  <ngc-weightdisplay formControlName="tonnageByContractor"></ngc-weightdisplay>
                </td>
                <td align="center" entityAttribute="Imp.BdSummary.BySats">
                  <ngc-weightdisplay formControlName="tonnageByGha"></ngc-weightdisplay>
                </td>
                <td align="center">
                  <ngc-weightdisplay formControlName="differece"></ngc-weightdisplay>
                </td>
                <td align="center">
                  <ngc-display formControlName="breakdownStaff"></ngc-display>
                </td>
                <td align="center" entityAttribute="Imp.BdSummary.BySats">
                  <ngc-dropdownlist formControlName="sats" sourceId="Lying_ListAD$DnCompleteFlag" [width]="100"
                    [noBlank]="true" valueMember="desc"></ngc-dropdownlist>
                </td>
                <td align="center">
                  <ngc-display formControlName="breakdownStartDataTime" type="displayDateTime"></ngc-display>
                </td>
                <td align="center">
                  <ngc-display formControlName="breakdownEndDataTime" type="displayDateTime"></ngc-display>
                </td>
                <td align="center">
                  <ngc-dropdownlist formControlName="serviceContrator" sourceId="BDSUMMARY_SERVICEPROVIDER"
                    sourceType="query" [sourceParameters]="sourceIdSegmentDropdown" [width]="200">
                  </ngc-dropdownlist>
                </td>
                <td align="center" feature="Imp.Ramp.WhDestination">
                  <ngc-display formControlName="warehouseDestination"></ngc-display>
                </td>
                <td align="center" feature="Imp.Ramp.ActualLocation">
                  <ngc-display formControlName="actualLocation"></ngc-display>
                </td>
                <td align="center">
                  <ngc-display formControlName="breakdownPieces"></ngc-display>/
                  <ngc-display formControlName="breakdownWeight"></ngc-display>
                </td>
                <td align="center" entityAttribute="Imp.Uld.Damage">
                  <ngc-display formControlName="damagedFlag"></ngc-display>
                </td>
              </tr>
              <ng-container formArrayName="shipments" entityAttribute="Imp.BdSummary.DisplayUldShipments">
                <tr *ngFor="let sitem of item.get('shipments').controls | first; let sindex=index"
                  [formGroupName]="sindex">
                  <td align="center">
                    <ngc-display formControlName="shipmentNumber"></ngc-display>
                  </td>
                  <td align="center">
                    <ngc-display formControlName="natureOfGoods"></ngc-display>
                  </td>
                </tr>
              </ng-container>
            </ng-container>
          </tbody>
        </ngc-table>
      </ngc-column>
    </ngc-row>

  </ngc-container>

  <ngc-container title="import.additional.tonnage.breakdown" type="section" *ngIf="isFlightInformation">
    <ngc-row>
      <ngc-column align="right">
        <ngc-label></ngc-label>
        <div>
          <ngc-button (click)="onAddParameters(index)" value="add.tonnage"></ngc-button>
        </div>
      </ngc-column>
    </ngc-row>
    <ngc-row>
      <ngc-column>
        <ngc-table>
          <thead>
            <th>
              <ngc-label label='g.cargo.type'></ngc-label>
            </th>
            <th>
              <ngc-label label='import.breakdown.tonnage.kg'></ngc-label>
            </th>
            <th>
              <ngc-label label='impport.breakdown.tonnage.add.kg'></ngc-label>
            </th>
            <th>
              <ngc-label label='import.breakdown.tonngge.subtract.kg'></ngc-label>
            </th>
            <th>
              <ngc-label label='g.remarks'></ngc-label>
            </th>
            <th>
              <ngc-label label='import.beakdown.service.contractor'></ngc-label>
            </th>
            <th>
              <ngc-label label=''></ngc-label>
            </th>

          </thead>
          <tbody formArrayName="tonnageHandlingInfo">
            <tr *ngFor="let item of searchForm.get('tonnageHandlingInfo').controls; let index=index"
              [formGroupName]="index">
              <td>
                <ngc-dropdownlist formControlName="cargoType" sourceId="BDSUMMARY_CARGOTYPE" sourceType="query"
                  [width]="200"></ngc-dropdownlist>
              </td>
              <td>
                <ngc-weightdisplay formControlName="tonnage"></ngc-weightdisplay>
              </td>
              <td>
                <ngc-weightinput formControlName="additionalTonnage"></ngc-weightinput>
              </td>
              <td>
                <ngc-weightinput formControlName="subtractTonnage"></ngc-weightinput>
              </td>
              <!-- <td>
                <ngc-remarksinput formControlName="remark" [width]="485" maxlength="65"></ngc-remarksinput>
              </td> -->
              <td>
                <ngc-textarea formControlName="remark" [width]="630" [height]="50" [maxlength]="400"></ngc-textarea>
              </td>
              <td>
                <ngc-dropdownlist formControlName="serviceContractor" sourceId="BDSUMMARY_SERVICEPROVIDER"
                  sourceType="query" [sourceParameters]="sourceIdSegmentDropdown" [width]="200" [autoSelect]="true">
                </ngc-dropdownlist>
              </td>

              <td>
                <ngc-link type="delete" iconType="delete" (click)="onDeleteParameters(index)"></ngc-link>
              </td>
            </tr>
          </tbody>
        </ngc-table>
      </ngc-column>
    </ngc-row>
  </ngc-container>

</form>
<form [formGroup]="breakDownSummary" *ngIf="isFlightInformation">
  <ngc-container type="section">

    <ngc-row>
      <ngc-column [column]="3">
        <ngc-label label='import.enter.reason.for.waive' width='20'></ngc-label>
        <div>
          <ngc-dropdownlist formControlName="reasonForWaive" sourceId="REASON_FOR_WAIVE" sourceType="query"
            [width]="200" valueMember="desc"></ngc-dropdownlist>
        </div>
      </ngc-column>

      <ngc-column [column]="2">
        <ngc-label entityAttribute="Imp.BdSummary.Delay" width='20'></ngc-label>
        <div>
          <ngc-dropdownlist formControlName="reasonForDelay" sourceId="REASON_FOR_DELAY" sourceType="query"
            [width]="200" valueMember="desc"></ngc-dropdownlist>
        </div>
      </ngc-column>

      <ngc-column>
        <ngc-label label='&nbsp' width='20'></ngc-label>
        <!-- <div>
          <ngc-icon type="alarm" trueColor="inherit" value="Y"></ngc-icon>
        </div> -->
      </ngc-column>
      <ngc-column [column]="2">
        <ngc-label label='import.beakdown.service.contractor' width='20'></ngc-label>
        <div>
          <ngc-dropdownlist formControlName="serviceContractorName" sourceId="BDSUMMARY_SERVICEPROVIDER"
            [sourceParameters]="sourceIdSegmentDropdown" sourceType="query" [width]="200"></ngc-dropdownlist>
        </div>
      </ngc-column>
      <ngc-column align="right">
        <ngc-label label='import.notify.party.email.id' width='20'></ngc-label>
        <!--<ngc-button label='Add' (click)="addEmail()" #searchbutton></ngc-button>-->
        <!-- <div> <ngc-taginput formArrayName="emails" dataField="toAddress" [width]="200" sourceId="BD_EMAIL_CONFIGURED"
          sourceType="query">
          </ngc-taginput>-->
        <div>
          <ngc-lov formControlName="emailGroup" sourceId="KEY_BD_EMAIL_CONFIGURED"  title="import.email"
            sourceType="query"  dataField="code">
            <ngc-data-column text="g.group.name" dataField="code" [width]="100"></ngc-data-column>
            <ngc-data-column text="g.group.description" [width]="150" dataField="desc"></ngc-data-column>
          </ngc-lov>
        </div>
        <!-- <ngc-lov [noCache]="true"  [autoFocus]="true"   formControlName="emails"  sourceId='EMAIL_GROUP_SI'  displayMember="desc"
           dataField="desc" [width]="250"  title='Email ID'></ngc-lov> BD_EMAIL_CONFIGURED-->

      </ngc-column>
    </ngc-row>

    <ngc-row>
      <ngc-column [column]="3">
        <ngc-checkbox formControlName="liquIdatedDamagesWaived">Liquidated Damages(LD) Waived</ngc-checkbox>

      </ngc-column>
      <ngc-column [column]="3" entityAttribute="Imp.BdSummary.LDApplicable">
        <ngc-checkbox formControlName="liquIdatedDamageApplicable">Liquidated Damages(LD) Applicable</ngc-checkbox>

      </ngc-column>
      <ngc-column align="right">
        <ngc-button label='send.email' (click)="addEmail()"></ngc-button>

      </ngc-column>
    </ngc-row>

  </ngc-container>
  <ngc-report #reportWindow title="g.report"  reportId='BreakdownSummary'  [reportParameters]='reportParameters'>
  </ngc-report>
</form>