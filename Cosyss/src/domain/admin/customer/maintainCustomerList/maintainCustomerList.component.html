<form [formGroup]="maintainlistForm">
  <ngc-titlebar title="maint.title" (clear)="onClear($event)" (cancel)="onBack($event)">
  </ngc-titlebar>
  <ngc-container type="tab">
    <ngc-row>
      <ngc-column column="2">
        <ngc-label label="maint.custType"></ngc-label>
        <div>
          <ngc-dropdownlist formControlName="customerType" upperCase='true' [multiSelect]="true"
            sourceId='CUSTOMER_TYPES' sourceType='query' required accessEnableOn="r"></ngc-dropdownlist>
        </div>
      </ngc-column>
      <ngc-column column="3">
        <ngc-label label="maint.custStatus"></ngc-label>
        <div>

          <ngc-dropdownlist formControlName="customerStatus" sourceId='Maintstatus$CustomerStatus' [width]="250"
            accessEnableOn="r"></ngc-dropdownlist>
        </div>
      </ngc-column>

      <ngc-column column="3" entityAttribute="Customer.SearchCustomerNameFrom">
        <ngc-label label="Customer.SearchCustomerNameFrom" entityAttribute="Customer.SearchCustomerNameFrom">
        </ngc-label>
        <div>
          <ngc-lov dataField='desc' valueMember='desc' formControlName='searchCustomerNameFrom' [width]='248'
            upperCase='true' sourceId='COMPANY_DEREGISTER_NAME' title='g.customerName' accessEnableOn="r"
            [dropDownWidth]='60' entityAttribute="Customer.SearchCustomerNameFrom">
            <ngc-data-column text='g.companyName' dataField='desc' [width]='190'></ngc-data-column>
            <ngc-data-column text='g.companyCode' dataField='code' [width]='100'></ngc-data-column>
          </ngc-lov>
        </div>
      </ngc-column>

      <ngc-column column="3" entityAttribute="Customer.SearchCustomerNameTo">
        <ngc-label label="Customer.SearchCustomerNameTo" entityAttribute="Customer.SearchCustomerNameTo"></ngc-label>
        <div>
          <ngc-lov dataField='desc' valueMember='desc' formControlName='searchCustomerNameTo' [width]='248'
            upperCase='true' sourceId='COMPANY_DEREGISTER_NAME' title='g.customerName' accessEnableOn="r"
            [dropDownWidth]='60' entityAttribute="Customer.SearchCustomerNameTo">
            <ngc-data-column text='g.companyName' dataField='desc' [width]='190'></ngc-data-column>
            <ngc-data-column text='g.companyCode' dataField='code' [width]='100'></ngc-data-column>
          </ngc-lov>
        </div>
      </ngc-column>

      <ngc-column column="1">

        <ngc-label label=""></ngc-label>
        <div>
          <ngc-button label="g.search" iconType="search" (click)="onSearch(0)" accessEnableOn="r"></ngc-button>
        </div>
      </ngc-column>
    </ngc-row>
  </ngc-container>
  <ngc-container *ngIf="isTableFlg" type="tab">
    <ngc-row>
      <ngc-column column="2">
        <ngc-label label="maint.active"></ngc-label>
        <div>
          <ngc-dropdownlist formControlName="activeFilter" sourceId='Active$ActiveImport' accessEnableOn="r">
          </ngc-dropdownlist>
        </div>
      </ngc-column>
      <ngc-column column="2" entityAttribute="Customer.ImportAuthorizationHolderFlag">
        <ngc-label label="maint.iaholder" entityAttribute="Customer.ImportAuthorizationHolderFlag"></ngc-label>
        <div>
          <ngc-dropdownlist formControlName="iaHolderFilter" entityAttribute="Customer.ImportAuthorizationHolderFlag"
            sourceId='IAHolder$IA_Holder' accessEnableOn="r">
          </ngc-dropdownlist>
        </div>
      </ngc-column>
      <ngc-column column="2">
        <ngc-label label="maint.blacklist"></ngc-label>
        <div>
          <ngc-dropdownlist formControlName="blackListFilter" sourceId='BlackList$BlacklistIndicator'
            accessEnableOn="r"></ngc-dropdownlist>
        </div>
      </ngc-column>
    </ngc-row>
  </ngc-container>

  <ngc-container *ngIf="isTableFlg" type="tab">
    <ngc-row>
      <ngc-column>
        <ngc-table>
          <thead align="left">
            <tr>
              <th>
                <ngc-label value="g.sNo"></ngc-label>
              </th>
              <th [width]="100">
                <ngc-label value="maint.custCode"></ngc-label>
              </th>
              <th [width]="100">
                <ngc-label value="maint.custName"></ngc-label>
              </th>
              <th [width]="100">
                <ngc-label value="maint.custType"></ngc-label>
              </th>
              <th [width]="100" entityAttribute="Customer.CustomerUniqueEntityNumber">
                <ngc-label value="maint.uenNumber" entityAttribute="Customer.CustomerUniqueEntityNumber"></ngc-label>
              </th>
              <th [width]="100" feature="Billing.CustomerPaymentAccount">
                <ngc-label value="customer.paymentAccountNumber1" feature="Billing.CustomerPaymentAccount"></ngc-label>
              </th>
              <th [width]="100" feature="Billing.CustomerPaymentAccount">
                <ngc-label value="customer.paymentAccountBalance1" feature="Billing.CustomerPaymentAccount"></ngc-label>
              </th>
              <th [width]="100" feature="Billing.CustomerPaymentAccount">
                <ngc-label value="customer.paymentAccountNumber2" feature="Billing.CustomerPaymentAccount"></ngc-label>
              </th>
              <th [width]="100" feature="Billing.CustomerPaymentAccount">
                <ngc-label value="customer.paymentAccountBalance2" feature="Billing.CustomerPaymentAccount"></ngc-label>
              </th>
              <th [width]="100" entityAttribute='Customer.TaxAccountNumber'>
                <ngc-label value="admin.pan.number" entityAttribute='Customer.TaxAccountNumber'></ngc-label>
              </th>
              <th [width]="100" feature='Billing.SalesTax'>
                <ngc-label value="billing.salestaxnumber" feature='Billing.SalesTax'></ngc-label>
              </th>
              <th [width]="100">
                <ngc-label value="maint.lastShipAssign"></ngc-label>
              </th>
              <th [width]="100">
                <ngc-label value="maint.lastUpdted"></ngc-label>
              </th>
              <th [width]="100">
                <ngc-label value="agent.appointed.agents"></ngc-label>
              </th>
              <th [width]="100">
                <ngc-label value="admin.maintain.customer.contractors"></ngc-label>
              </th>
              <th [width]="100" entityAttribute="Customer.HaffaMember">
                <ngc-label value="Customer.HaffaMember" entityAttribute="Customer.HaffaMember"></ngc-label>
              </th>
              <th [width]="100" entityAttribute="Customer.AISRSMember">
                <ngc-label value="Customer.AISRSMember" entityAttribute="Customer.AISRSMember"></ngc-label>
              </th>
              <th [width]="100" entityAttribute="Customer.RACSF">
                <ngc-label value="Customer.RACSF" entityAttribute="Customer.RACSF"></ngc-label>
              </th>
              <th [width]="100" entityAttribute="Customer.ConsigneeFlag">
                <ngc-label value="Customer.ConsigneeFlag" entityAttribute="Customer.ConsigneeFlag"></ngc-label>
              </th>
              <th [width]="100" entityAttribute="Customer.AgentPortalAccess">
                <ngc-label value="Customer.AgentPortalAccess" entityAttribute="Customer.AgentPortalAccess"></ngc-label>
              </th>
              <th [width]="100" entityAttribute="Customer.ReturnAuthorisationNumber">
                <ngc-label value="Customer.ReturnAuthorisationNumber"
                  entityAttribute="Customer.ReturnAuthorisationNumber"></ngc-label>
              </th>
              <th [width]="100" entityAttribute="Customer.AATCredit">
                <ngc-label entityAttribute="Customer.AATCredit">
                </ngc-label>
              </th>
              <th [width]="100" entityAttribute="Customer.AirlineCredit">
                <ngc-label entityAttribute="Customer.AirlineCredit">
                </ngc-label>
              </th>
            </tr>
          </thead>
          <tbody formArrayName="CustomerListDetails">
            <tr *ngFor="let item of maintainlistForm.controls.CustomerListDetails.controls; let index=index"
              [formGroupName]="index">
              <td>
                {{currentPageIndex*10 + index + 1}}
              </td>
              <td>
                <ngc-display formControlName="customerCode"></ngc-display>
              </td>
              <td>
                <ngc-link (click)="onEditClick(index)" formControlName="customerName"></ngc-link>
              </td>
              <td>
                <ngc-display formControlName="customerType"></ngc-display>
              </td>
              <td entityAttribute="Customer.CustomerUniqueEntityNumber">
                <ngc-display formControlName="uenNumber" entityAttribute="Customer.CustomerUniqueEntityNumber">
                </ngc-display>
              </td>
              <td feature="Billing.CustomerPaymentAccount">
                <ngc-display formControlName="paymentAccountNumber1" feature="Billing.CustomerPaymentAccount">
                </ngc-display>
              </td>
              <td align="right" feature="Billing.CustomerPaymentAccount">
                <ngc-currencydisplay formControlName="paymentAccountBalance1" feature="Billing.CustomerPaymentAccount">
                </ngc-currencydisplay>
              </td>
              <td feature="Billing.CustomerPaymentAccount">
                <ngc-display formControlName="paymentAccountNumber2" feature="Billing.CustomerPaymentAccount">
                </ngc-display>
              </td>
              <td align="right" feature="Billing.CustomerPaymentAccount">
                <ngc-currencydisplay formControlName="paymentAccountBalance2" feature="Billing.CustomerPaymentAccount">
                </ngc-currencydisplay>
              </td>
              <td entityAttribute='Customer.TaxAccountNumber'>
                <ngc-display formControlName="panNumber" entityAttribute='Customer.TaxAccountNumber'>
                </ngc-display>
              </td>
              <td feature='Billing.SalesTax'>
                <ngc-display formControlName="salesTaxNumber" feature='Billing.SalesTax'>
                </ngc-display>
              </td>
              <td>
                <ngc-display formControlName="lastShipmentAssignment" [onlyDate]="true"></ngc-display>
              </td>
              <td>
                <ngc-display formControlName="lastUpdated" [onlyDate]="true"></ngc-display>
              </td>

              <td formArrayName="agentCustomerRelatedAgents">
                <ng-container
                  *ngFor="let customerRecord of item.controls.agentCustomerRelatedAgents.controls; let sindex=index"
                  [formGroupName]="sindex">
                  <ngc-display formControlName="customerCode"></ngc-display><br />
                </ng-container>
              </td>

              <td formArrayName="contractorRelatedToCustomer">
                <ng-container
                  *ngFor="let customerRecord of item.controls.contractorRelatedToCustomer.controls; let sindex=index"
                  [formGroupName]="sindex">
                  <ngc-display formControlName="customerCode"></ngc-display><br />
                </ng-container>
              </td>

              <td align="center" entityAttribute="Customer.HaffaMember">
                <ngc-icon type="yesno" formControlName="hafffaMember" entityAttribute="Customer.HaffaMember"></ngc-icon>
              </td>

              <td align="center" entityAttribute="Customer.AISRSMember">
                <ngc-icon type="yesno" formControlName="aisrsMember" entityAttribute="Customer.AISRSMember"></ngc-icon>
              </td>

              <td align="center" entityAttribute="Customer.RACSF">
                <ngc-icon type="yesno" formControlName="racsf" entityAttribute="Customer.RACSF"></ngc-icon>
              </td>

              <td align="center" entityAttribute="Customer.ConsigneeFlag">
                <ngc-icon type="yesno" formControlName="isConsignee" entityAttribute="Customer.ConsigneeFlag">
                </ngc-icon>
              </td>

              <td align="center" entityAttribute="Customer.AgentPortalAccess">
                <ngc-icon type="yesno" formControlName="hasAgentPortalAccess"
                  entityAttribute="Customer.AgentPortalAccess"></ngc-icon>
              </td>

              <td entityAttribute="Customer.ReturnAuthorisationNumber">
                <ngc-display formControlName="ranNumber" entityAttribute="Customer.ReturnAuthorisationNumber">
                </ngc-display>
              </td>
              <td entityAttribute="Customer.AATCredit">
                <ngc-link iconType="edit" (linkClick)="customerBillingSetup(index)">
                </ngc-link>
              </td>
              <td entityAttribute="Customer.AirlineCredit">
                <ngc-link iconType="edit" (linkClick)="customerBillingSetup(index)">
                </ngc-link>
              </td>

            </tr>
          </tbody>
        </ngc-table>
      </ngc-column>

    </ngc-row>
    <ngc-row>
      <ngc-column column="3.5"></ngc-column>
      <ngc-column column="1">
        <ngc-button accessEnableOn="r" value="g.prev" (click)="onClickPrev()"></ngc-button>
      </ngc-column>
      <ngc-column column="2">
        <ngc-label emphasis="md"  label="Page No.:"></ngc-label>&nbsp;&nbsp;
        <ngc-numberinput decimalDigits="0" [min]="1" [max]="this.rowLimit" [width]="50"
          formControlName="currentPageIndexNew">
        </ngc-numberinput>&nbsp;
        <ngc-label *ngIf="this.rowLimit>1" emphasis="md" label="of {{this.rowLimit}} pages"></ngc-label>
        <ngc-label *ngIf="this.rowLimit<=1" emphasis="md" label="of {{this.rowLimit}} page"></ngc-label>
      </ngc-column>
      <ngc-column column="1.5">
        <ngc-label *ngIf="noOfRecords!=0" emphasis="md"
           label="Records: {{currentPageIndex*10+1}} - {{this.maxDataCount}} of {{noOfRecords}}"></ngc-label>
        <ngc-label *ngIf="noOfRecords==0" emphasis="md"
           label="Records: {{0}} - {{this.maxDataCount}} of {{noOfRecords}}"></ngc-label>
      </ngc-column>
      <ngc-column>
        <ngc-button accessEnableOn="r" value="g.next" (click)="onClickNext()"></ngc-button>
      </ngc-column>
    </ngc-row>
  </ngc-container>
  <ngc-container>
    <ngc-row>
      <ngc-column>

      </ngc-column>
    </ngc-row>

  </ngc-container>

  <ngc-container *ngIf="isTableFlg" type="tab">
    <ngc-row>
      <ngc-column>
        <ngc-row>
          <ngc-column align="right">
            <ngc-button label="maint.exporttoPDF" (click)="onExportEmails($event)"></ngc-button>
            <ngc-button label="maint.exporttoemailaddress" (click)="onExportEmail($event)"></ngc-button>
          </ngc-column>
        </ngc-row>
      </ngc-column>
    </ngc-row>

  </ngc-container>
  <ngc-report  format='xls' #reportWindow1 title="g.report"  reportId='withaddress_rptdesign'
     [reportParameters]='reportParameters'></ngc-report>
  <ngc-report  format='xls' #reportWindow2 title="g.report"  reportId='withoutaddress_report'
     [reportParameters]='reportParameters'></ngc-report>


  <ngc-window #selectWindow [width]="50" title="admin.select.list.of.customers" [showCloseButton]="true">
    <ngc-container type="tab">
      <ngc-row>
        <ngc-column>
          <ngc-radiobutton groupName="sel" formControlName="withaddress" checked="checked">
            <ngc-label label="customer.with.address"></ngc-label>
          </ngc-radiobutton>
        </ngc-column>
      </ngc-row>
      <ngc-row>
        <ngc-column>
          <ngc-radiobutton groupName="sel" formControlName="withoutaddress">
            <ngc-label label="customer.without.address"></ngc-label>
          </ngc-radiobutton>
        </ngc-column>
      </ngc-row>
    </ngc-container>
    <ngc-window-footer>
      <ngc-container type="tab">
        <ngc-row>
          <ngc-column align="right">
            <ngc-button value="g.ok" (click)="onServiceReport()"></ngc-button>
          </ngc-column>
        </ngc-row>
      </ngc-container>
    </ngc-window-footer>
  </ngc-window>
</form>