<ngc-titlebar title="export.uld.details.title" (cancel)="onCancel($event)"></ngc-titlebar>
<form [formGroup]="uldDetailsForm">
  <ngc-container type="tab">
    <ngc-row>
      <ngc-column column=4 [grid48]="true">
        <ngc-label label="flight.Flight"></ngc-label>
        <div>
          <ngc-display formControlName="flight"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column column=4 [grid48]="true">
        <ngc-label label="wrkLst.Aircraft"></ngc-label>
        <div>
          <ngc-display formControlName="aircraftType"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column column=4 [grid48]="true">
        <ngc-label label="flight.date"></ngc-label>
        <div>
          <ngc-display formControlName="flightDate" [onlyDate]="true"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column column=2 [grid48]="true">
        <ngc-label label="flight.std"></ngc-label>
        <div>
          <ngc-display formControlName="dateStd" [onlyTime]="true"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column column=4 [grid48]="true">
        <ngc-label label="flight.etd"></ngc-label>
        <div *ngIf="showDateFlag">
          <ngc-display formControlName="dateEtd"></ngc-display>
        </div>
        <div *ngIf="!showDateFlag">
          <ngc-display formControlName="etd"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column column=10 [grid48]="true">
        <div *ngIf="dlsFalg">
          <strong style="color:red;"> DLS Has Been Finalized -
            <ngc-display formControlName="dlsFinalizeAt"></ngc-display>
          </strong>
        </div>
        <ngc-row>
          <ngc-column>
            <ngc-label label="export.uld.details.dls.version"></ngc-label>
            <div>
              <ngc-display formControlName="dlsVersion"></ngc-display>
            </div>
          </ngc-column>
          <ngc-column>
            <ngc-label label="export.uld.details.finalize.status"></ngc-label>
            <div>
              <ngc-display formControlName="finalizeStatus"></ngc-display>
            </div>
          </ngc-column>
        </ngc-row>
      </ngc-column>
      <ngc-column column=4 [grid48]="true">
        <ngc-label label="g.status"></ngc-label>
        <div>
          <ngc-display formControlName="status"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column column=4 [grid48]="true">
        <ngc-label label="g.terminal"></ngc-label>
        <div>
          <ngc-display formControlName="terminals"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column>
        <ngc-label label="flight.bay"></ngc-label>
        <div>
          <ngc-display formControlName="bay"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column>
        <ngc-label label="g.uld"></ngc-label>
        <div>
          <ngc-display formControlName="uld"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column>
        <ngc-label label="g.trolley"></ngc-label>
        <div>
          <ngc-display formControlName="trolley"></ngc-display>
        </div>
      </ngc-column>
      <ngc-column>
        <ngc-label label=" "></ngc-label>
        <div>
          <ngc-button accessEnableOn="r" (click)="viewOsiRemarks()" value="OSI"></ngc-button>
        </div>
      </ngc-column>
    </ngc-row>
    <ngc-row>
      <ngc-column column="8"></ngc-column>
      <ngc-column column="4" *ngIf="isactiveByDefault">
        <ngc-datatable formArrayName="airlineLoadingInstructions" [pageable]="false" [enablePageSizeHeight]="false">
          <ngc-data-column text=" " dataField="loadingInstruction" cellsAlign="center"></ngc-data-column>
          <ngc-data-column text="g.pallet" dataField="totalPallet" cellsAlign="center"></ngc-data-column>
          <ngc-data-column text="g.container" dataField="totlContainer" cellsAlign="center"></ngc-data-column>
          <ngc-data-column text="g.bt" dataField="totalBt" cellsAlign="center"></ngc-data-column>
        </ngc-datatable>
      </ngc-column>
      <ngc-column [column]="4" formGroupName="uldtypeali" *ngIf="isactiveByUld">
        <div style="height: 170px; overflow-y: auto">
          <ngc-table style="height: 400px">
            <thead>
              <tr>
                <th>
                  <ngc-label label="uld.uld.type"></ngc-label>
                </th>
                <th>
                  <ngc-label label="billing.total.sgd"></ngc-label>
                </th>
                <th>
                  <ngc-label label="ewl.cargo.offer"></ngc-label>
                </th>
                <th>
                  <ngc-label label="ewl.cargo.used"></ngc-label>
                </th>
                <th>
                  <ngc-label label="billing.paymentaccountbalance"></ngc-label>
                </th>
              </tr>
            </thead>
            <ng-container *ngFor="let item of uldDetailsForm.get('uldtypeali').controls; let index=index"
              [formGroupName]="index">
              <tr>
                <td>
                  <ngc-display [width]="40" formControlName="uldType">
                  </ngc-display>
                </td>
                <td>
                  <ngc-display formControlName="totalUldType" [width]="40">
                  </ngc-display>
                </td>
                <td>
                  <ngc-display [width]="40" formControlName="totalUldType">
                  </ngc-display>
                </td>
                <td>
                  <ngc-display [width]="40" formControlName="uldTypeUsed">
                  </ngc-display>
                </td>
                <td>
                  <ngc-display [width]="40" formControlName="remainingUldType">
                  </ngc-display>
                </td>
              </tr>
            </ng-container>

          </ngc-table>
        </div>
      </ngc-column>
      <!--Height Type Airline Loading Instructions-->
      <ngc-column [column]="4" formGroupName="heighttypeali" *ngIf="isactiveByHeight">
        <div style="height: 170px; overflow-y: auto">
          <ngc-table style="height: 400px">
            <thead>
              <tr>
                <th>
                  <ngc-label label="uld.heightcode"></ngc-label>
                </th>
                <th>
                  <ngc-label label="billing.total.sgd"></ngc-label>
                </th>
                <th>
                  <ngc-label label="ewl.cargo.offer"></ngc-label>
                </th>
                <th>
                  <ngc-label label="ewl.cargo.used"></ngc-label>
                </th>
                <th>
                  <ngc-label label="billing.paymentaccountbalance"></ngc-label>
                </th>
              </tr>
            </thead>
            <ng-container *ngFor="let item of uldDetailsForm.get('heighttypeali').controls; let index=index"
              [formGroupName]="index">
              <tr>
                <td>
                  <ngc-display [width]="40" formControlName="heightCode">
                  </ngc-display>
                </td>
                <td>
                  <ngc-display formControlName="totalHeightType" [width]="40">
                  </ngc-display>
                </td>
                <td>
                  <ngc-display [width]="40" formControlName="totalHeightType">
                  </ngc-display>
                </td>
                <td>
                  <ngc-display [width]="40" formControlName="heightTypeUsed">
                  </ngc-display>
                </td>
                <td>
                  <ngc-display [width]="40" formControlName="remainingHeightType">
                  </ngc-display>
                </td>
              </tr>
            </ng-container>

          </ngc-table>
        </div>
      </ngc-column>
      <!--Allotment Type Airline Loading Instructions-->
      <ngc-column [column]="4" formGroupName="allotmenttypeali" *ngIf="isactiveByAllotment">
        <div style="height: 170px; overflow-y: auto">
          <ngc-table style="height: 400px">
            <thead>
              <tr>
                <th>
                  <ngc-label label="ewl.allotment"></ngc-label>
                </th>
                <th>
                  <ngc-label label="billing.total.sgd"></ngc-label>
                </th>
                <th>
                  <ngc-label label="ewl.cargo.offer"></ngc-label>
                </th>
                <th>
                  <ngc-label label="ewl.cargo.used"></ngc-label>
                </th>
                <th>
                  <ngc-label label="billing.paymentaccountbalance"></ngc-label>
                </th>
              </tr>
            </thead>
            <ng-container *ngFor="let item of uldDetailsForm.get('allotmenttypeali').controls; let index=index"
              [formGroupName]="index">
              <tr>
                <td>
                  <ngc-display [width]="40" formControlName="allotmentType">
                  </ngc-display>
                </td>
                <td>
                  <ngc-display formControlName="totalAllotment" [width]="40">
                  </ngc-display>
                </td>
                <td>
                  <ngc-display [width]="40" formControlName="totalAllotment">
                  </ngc-display>
                </td>
                <td>
                  <ngc-display [width]="40" formControlName="usedAllotment">
                  </ngc-display>
                </td>
                <td>
                  <ngc-display [width]="40" formControlName="remainingAllotmentType">
                  </ngc-display>
                </td>
              </tr>
            </ng-container>

          </ngc-table>
        </div>
      </ngc-column>
    </ngc-row>
    <ngc-row>
      <ngc-column>
        <ngc-tabs (select)="releaseEvent($event)">
          <div ngc-tab-card title="export.uld.details.not.released">
            <ngc-row>
              <ngc-column>
                <ngc-button [disabled]="hasReadPermission" label="export.uld.details.group" (click)=onGroup()></ngc-button>
                <ngc-button [disabled]="hasReadPermission" label="export.uld.details.ungroup" (click)=onUnGroup()></ngc-button>
                <ngc-column align="right">
                  <ngc-button [disabled]="hasReadPermission" label="export.uld.details.group.ramp.release" (click)=onRampRelease()>
                  </ngc-button>
                </ngc-column>
              </ngc-column>
            </ngc-row>
            <ngc-row>
              <ngc-column>
                <ngc-datatable formArrayName="notReleasedTrolleyList" (itemSelect)="onSelectCheckBox($event)">
                  <ngc-data-column text='g.select' [width]="100" dataField="notReleasedCheckBox" type="check">
                  </ngc-data-column>
                  <ngc-data-column text='uld.uld.trolley' [width]="100" dataField="containerTrolleyNumber">
                  </ngc-data-column>
                  <ngc-data-column text='g.pdNumber' [width]="100" dataField="pdNumber"></ngc-data-column>
                  <ngc-data-column text='TT/TTT' [width]="100" dataField="transferType"></ngc-data-column>
                  <ngc-data-column text='export.uld.details.group' [width]="100" dataField="group"></ngc-data-column>
                  <ngc-data-column text='uld.destination' [width]="100" dataField="destination"></ngc-data-column>
                  <ngc-data-column text='g.handlingArea' [width]="100" dataField="handlingArea"></ngc-data-column>
                  <ngc-data-column text='g.shc' [width]="100" dataField="shc"></ngc-data-column>
                  <ngc-data-column text='g.remarks' [width]="100" dataField="remarks"></ngc-data-column>
                  <ngc-data-column text='uld.contentcode' [width]="100" dataField="contentCode"></ngc-data-column>
                </ngc-datatable>
              </ngc-column>
            </ngc-row>
          </div>
          <div ngc-tab-card title="export.uld.details.released">
            <ngc-row>
              <ngc-column>
                <ngc-button label="export.uld.details.reprint" (click)="rePrintRelease()"></ngc-button>
                <ngc-button label="export.offload.handover" (click)="offloadHandover()"></ngc-button>
                <ngc-button label="export.return.to.warehouse" (click)="returnToWareHouse()"></ngc-button>
              </ngc-column>
            </ngc-row>
            <ngc-row>
              <ngc-column>
                <ngc-datatable formArrayName="releasedTrolleyList" #releasedtable
                  (itemSelect)="onSelectReleasedCheckBox($event)">
                  <ngc-data-column text='g.select' [width]="100" dataField="releasedCheckBox" type="check">
                  </ngc-data-column>
                  <ngc-data-column text='export.uld.details.hand.carry.ocs.uld.trolley' [width]="200"
                    dataField="containerTrolleyNumber"></ngc-data-column>
                  <ngc-data-column text='TT/TTT' [width]="100" dataField="transferType"></ngc-data-column>
                  <ngc-data-column text='export.uld.details.group' [width]="100" dataField="group"></ngc-data-column>
                  <ngc-data-column text='uld.destination' [width]="200" dataField="destination"></ngc-data-column>
                  <ngc-data-column text='export.uld.details.return.status' [width]="100" dataField="returnFlag"
                    type="icon" iconType="yesno"></ngc-data-column>
                  <ngc-data-column text='export.uld.details.offload.status' [width]="100" dataField="offloadFlag"
                    type="icon" iconType="yesno"></ngc-data-column>
                  <ngc-data-column text='export.uld.details.surplus' [width]="100" dataField="surPlus" type="icon"
                    iconType="yesno"></ngc-data-column>
                  <ngc-data-column text='g.handlingArea' [width]="200" dataField="handlingArea"></ngc-data-column>
                  <ngc-data-column text='export.uld.details.bay' [width]="200" dataField="bay"></ngc-data-column>
                  <ngc-data-column text='g.shc' [width]="200" dataField="shc"></ngc-data-column>
                  <ngc-data-column text='export.uld.details.release.location' [width]="200" dataField="releaseLocation">
                  </ngc-data-column>
                  <ngc-data-column text='export.uld.details.driver.id' [width]="200" dataField="driverId">
                  </ngc-data-column>
                  <ngc-data-column text='export.uld.details.release.date' [width]="200" dataField="releasedDate">
                  </ngc-data-column>
                  <ngc-data-column text='export.uld.details.release.user' [width]="200" dataField="releasedUser">
                  </ngc-data-column>
                  <ngc-data-column text='export.uld.details.no.of.bags' [width]="200" dataField="noOfBags">
                  </ngc-data-column>
                  <ngc-data-column text='g.remarks' [width]="200" dataField="remarks"></ngc-data-column>
                  <ngc-data-column text='uld.contentcode' [width]="100" dataField="contentCode"></ngc-data-column>
                </ngc-datatable>
              </ngc-column>
            </ngc-row>
          </div>
        </ngc-tabs>
      </ngc-column>
    </ngc-row>
    <ngc-row>
      <ngc-column *ngIf="additionalInfoFlag">
        <ngc-label label="export.uld.details.additional.info.offload"></ngc-label>
        <ngc-table>
          <thead>
            <tr>
              <th>
                <ngc-label label="uld.uld.trolley"></ngc-label>
              </th>
              <th>
                <ngc-label label="flight.flightKey"></ngc-label>
              </th>
              <th>
                <ngc-label label="flight.flightDate"></ngc-label>
              </th>
              <th>
                <ngc-label label="export.uld.details.driver.id"></ngc-label>
              </th>
              <th>
                <ngc-label label="export.uld.details.no.of.bags"></ngc-label>
              </th>
              <th>
                <ngc-label label="export.uld.details.recieved.by.user"></ngc-label>
              </th>
              <th>
                <ngc-label label="export.uld.details.recieved.by.date"></ngc-label>
              </th>
              <th>
                <ngc-label label="export.uld.details.version"></ngc-label>
              </th>
              <th>
                <ngc-label label="export.reason"></ngc-label>
              </th>
            </tr>
          </thead>
          <tbody formArrayName="additionalInfo">
            <tr *ngFor="let item of uldDetailsForm.controls.additionalInfo.controls; let index=index"
              [formGroupName]="index">
              <td>
                <ngc-display formControlName="containerTrolleyNumber"></ngc-display>
              </td>
              <td>
                <ngc-display formControlName="flightKey"></ngc-display>
              </td>
              <td>
                <ngc-display formControlName="flightDate"></ngc-display>
              </td>
              <td>
                <ngc-display formControlName="driverId"></ngc-display>
              </td>
              <td>
                <ngc-display formControlName="noOfBags"></ngc-display>
              </td>
              <td>
                <ngc-display formControlName="handoverBy"></ngc-display>
              </td>
              <td>
                <ngc-display formControlName="handoverDateTime"></ngc-display>
              </td>
              <td>
                <ngc-display formControlName="version"></ngc-display>
              </td>
              <td>
                <ngc-display formControlName="remarks"></ngc-display>
              </td>
            </tr>
          </tbody>
        </ngc-table>
      </ngc-column>
      <ngc-column *ngIf="additionalInfoForReturnFlag">
        <ngc-label label="export.uld.details.additional.info.return"></ngc-label>
        <ngc-table>
          <thead>
            <tr>
              <th>
                <ngc-label label="uld.uld.trolley"></ngc-label>
              </th>
              <th>
                <ngc-label label="flight.flightKey"></ngc-label>
              </th>
              <th>
                <ngc-label label="flight.flightDate"></ngc-label>
              </th>
              <th>
                <ngc-label label="export.uld.details.driver.id"></ngc-label>
              </th>
              <th>
                <ngc-label label="export.uld.details.no.of.bags"></ngc-label>
              </th>
              <th>
                <ngc-label label="export.uld.details.recieved.by.user"></ngc-label>
              </th>
              <th>
                <ngc-label label="export.uld.details.recieved.by.date"></ngc-label>
              </th>
              <th>
                <ngc-label label="export.uld.details.version"></ngc-label>
              </th>
              <th>
                <ngc-label label="export.reason"></ngc-label>
              </th>
            </tr>
          </thead>
          <tbody formArrayName="additionalInfoForReturn">
            <tr *ngFor="let item of uldDetailsForm.controls.additionalInfoForReturn.controls; let index=index"
              [formGroupName]="index">
              <td>
                <ngc-display formControlName="containerTrolleyNumber"></ngc-display>
              </td>
              <td>
                <ngc-display formControlName="flightKey"></ngc-display>
              </td>
              <td>
                <ngc-display formControlName="flightDate"></ngc-display>
              </td>
              <td>
                <ngc-display formControlName="driverId"></ngc-display>
              </td>
              <td>
                <ngc-display formControlName="noOfBags"></ngc-display>
              </td>
              <td>
                <ngc-display formControlName="handoverBy"></ngc-display>
              </td>
              <td>
                <ngc-display formControlName="handoverDateTime"></ngc-display>
              </td>
              <td>
                <ngc-display formControlName="version"></ngc-display>
              </td>
              <td>
                <ngc-display formControlName="remarks"></ngc-display>
              </td>
            </tr>
          </tbody>
        </ngc-table>
      </ngc-column>
    </ngc-row>
  </ngc-container>

  <!-- WINDOW POP-UP -->

  <ngc-window #uldDetailsWindow title="export.uld.details.title" [cancelButton]="true" [width]="500" [height]="50">
    <ngc-container [formGroup]="uldReleasedDetailsForm" type="tab">
      <ngc-row>
        <ngc-column column=3>
          <ngc-label label="uld.uldNumber"></ngc-label>
          <div>
            <ngc-display formControlName="containerTrolleyNumber"></ngc-display>
          </div>
        </ngc-column>
        <ngc-column column=3>
          <ngc-label label="export.uld.details.release.date"></ngc-label>
          <div>
            <ngc-display formControlName="releasedDate"></ngc-display>
          </div>
        </ngc-column>
        <ngc-column column=3>
          <ngc-label label="export.uld.details.release.user"></ngc-label>
          <div>
            <ngc-display formControlName="releasedUser"></ngc-display>
          </div>
        </ngc-column>
        <ngc-column column=3>
          <ngc-label label="export.uld.details.driver.id"></ngc-label>
          <div>
            <ngc-display formControlName="driverId"></ngc-display>
          </div>
        </ngc-column>
      </ngc-row>
      <ngc-row>
        <ngc-column>
          <ngc-label></ngc-label>
        </ngc-column>
      </ngc-row>
      <ngc-row>

        <ngc-column column=3>
          <ngc-label label="g.handlingArea"></ngc-label>
          <div>
            <ngc-display formControlName="handlingArea"></ngc-display>
          </div>
        </ngc-column>
        <ngc-column column=3>
          <ngc-label label="export.uld.details.parking.bay"></ngc-label>
          <div>
            <ngc-display formControlName="bay"></ngc-display>
          </div>
        </ngc-column>
        <ngc-column column=3>
        </ngc-column>
      </ngc-row>
    </ngc-container>
  </ngc-window>
  <ngc-window #osiWindow title="OSI" [showCloseButton]="true" width="800" height="500">
    <ngc-container type="section">
      <ngc-row>
        <ngc-column>

          <ngc-table>
            <thead>
              <tr>
                <th>
                  <ngc-label label="g.sNo"></ngc-label>
                </th>
                <th>
                  <ngc-label label="export.details"></ngc-label>
                </th>
              </tr>
            </thead>
            <tr *ngFor="let item of uldDetailsForm.get('osiRemarks').value; let i=index">
              <td>
                <ngc-display [value]="i+1"></ngc-display>
              </td>
              <td>
                <ngc-display [value]="item"></ngc-display>
              </td>
            </tr>
          </ngc-table>
        </ngc-column>
      </ngc-row>
    </ngc-container>
  </ngc-window>
</form>


<form [formGroup]='popupPrinterForm'>
  <ngc-window #windowPrinter [width]="400" [height]="70" title="export.select.printer">
    <ngc-container type="box">
      <ngc-row>
        <ngc-column>
          <ngc-label label="g.printer"></ngc-label>
        </ngc-column>
      </ngc-row>
      <ngc-row>
        <ngc-column>
          <ngc-printer [width]='200' formControlName="printerdropdown" [printerTypeList]="['HANDOVER']"></ngc-printer>
        </ngc-column>
        <ngc-column>
        </ngc-column>
        <ngc-column>
          <ngc-button (click)="printHandover()" value="g.print"></ngc-button>
        </ngc-column>
      </ngc-row>
    </ngc-container>
  </ngc-window>
</form>