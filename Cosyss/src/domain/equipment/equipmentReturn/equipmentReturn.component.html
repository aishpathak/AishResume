<form [formGroup]='searchReleaseReturnForm'>
  <!-- Title Bar (Begin) -->
  <ngc-titlebar title="equipment.release.returnreport" (cancel)="onBack($event)" (print)="onprint()"></ngc-titlebar>
  <ngc-container type="tab">
    <ngc-row>
      <ngc-column>
        <ngc-label label="g.terminal"></ngc-label>
        <div>
          <ngc-dropdownlist accessEnableOn="r" formControlName="terminalpoint" sourceId='WAREHOUSE_TERMINAL'
            sourceType='query' [width]="100"></ngc-dropdownlist>
        </div>
      </ngc-column>
      <ngc-column>
        <ngc-label label="equipment.agent"></ngc-label>
        <div>
          <ngc-lov accessEnableOn="r" formControlName="agent" [width]="70" sourceId="CUSTOMER_LIST" title="g.agent"
            dataField="code">
            <ngc-data-column text="equipment.agent" dataField="code" [width]="30"></ngc-data-column>
          </ngc-lov>
        </div>
      </ngc-column>
      <ngc-column>
        <ngc-label label="equipment.requestedfrom.datetime"></ngc-label>
        <div>
          <ngc-datetimeinput accessEnableOn="r" formControlName="fromDate" [showCalendarButton]="true"
            placeHolder="g.fromDate" [showTimeButton]="true"></ngc-datetimeinput>
        </div>
      </ngc-column>
      <ngc-column>
        <ngc-label label="equipment.to.datetime"></ngc-label>
        <div>
          <ngc-datetimeinput accessEnableOn="r" formControlName="toDate" [showCalendarButton]="true"
            placeHolder="g.toDate" [showTimeButton]="true"></ngc-datetimeinput>
        </div>
      </ngc-column>
      <ngc-column>
        <ngc-label label="equipment.equipment.type"></ngc-label>
        <div>
          <ngc-dropdownlist accessEnableOn="r" formControlName="equipmentType" sourceId="Equipment$Equip_Equipment"
            [width]="140"></ngc-dropdownlist>
        </div>
      </ngc-column>
      <ngc-column>
        <ngc-label label="g.equipment"></ngc-label>
        <div>
          <ngc-input accessEnableOn="r" formControlName="equipmentNumber" [width]="100">
          </ngc-input>
        </div>
      </ngc-column>
      <ngc-column>
        <ngc-label label="equipment.dwell.timefrom"></ngc-label>
        <div>
          <ngc-input accessEnableOn="r" formControlName="dwellTimefrom" [width]="150">
          </ngc-input>
        </div>
      </ngc-column>
      <ngc-column>
        <ngc-label label="equipment.dwell.timeto"></ngc-label>
        <div>
          <ngc-input accessEnableOn="r" formControlName="dwellTimeto" [width]="150">
          </ngc-input>
        </div>
      </ngc-column>
      <ngc-column>
        <ngc-label label="equipment.equipment.status"></ngc-label>
        <div>
          <ngc-dropdownlist accessEnableOn="r" formControlName="equipmentstatus" sourceId="Equipment$EquipStatus"
            [width]="150"></ngc-dropdownlist>
        </div>
      </ngc-column>
      <ngc-column>
        <ngc-label label=""></ngc-label>
        <div>
          <ngc-input accessEnableOn="r" formControlName="requestTransactionNumber"
            placeHolder="equipment.request.number" [width]="150"></ngc-input>
        </div>
      </ngc-column>
      <ngc-column>
        <ngc-label label=""></ngc-label>
        <div>
          <ngc-input accessEnableOn="r" formControlName="transactionNumber" placeHolder="equipment.trip.number"
            [width]="150">
          </ngc-input>
        </div>
      </ngc-column>
      <ngc-column>
        <ngc-label>

        </ngc-label>
        <div>
          <ngc-button accessEnableOn="r" (click)="onSearch($event)" value="g.search" iconType="search">
          </ngc-button>
        </div>
      </ngc-column>
      <ngc-column>
        <ngc-label>

        </ngc-label>
        <div>
          <ngc-button accessEnableOn="r" (click)="onReqSummary($event)" value="equipment.fulfillment.summary"
            iconType="search">
          </ngc-button>
        </div>
      </ngc-column>
      <ngc-column column="4">
        <ngc-label label=""></ngc-label>
      </ngc-column>
    </ngc-row>

  </ngc-container>
  <ngc-container *ngIf='isTable' type="tab">
    <ngc-row>
      <ngc-column column="12">
        <ngc-edittable formArrayName="equipmentreleasereturndetail">
          <ngc-data-column [width]='10' text="g.sel" dataField="select" align="center">
            <ng-template let-name="name" let-group="group">
              <ng-container [formGroupName]="group">
                <ngc-checkbox [width]='10' formControlName="select" (click)="onSelect($event,group)"></ngc-checkbox>
              </ng-container>
            </ng-template>
          </ngc-data-column>
          <ngc-data-column [width]='10' text="equipment.equipment.number.br" dataField="equipmentNumber" align="center">
            <ng-template let-name="name" let-group="group">
              <ng-container [formGroupName]="group">
                <ngc-display [width]='10' formControlName="equipmentNumber"></ngc-display>
              </ng-container>
            </ng-template>
          </ngc-data-column>
          <ngc-data-column text="equipment.shipment.number.br" dataField="shipmentNumber" align="center">
          </ngc-data-column>
          <ngc-data-column text="equipment.agent" dataField="agent" align="center"></ngc-data-column>
          <ngc-data-column text="equipment.flight.carrier.br" dataField="flightKey" align="center"></ngc-data-column>
          <ngc-data-column text="g.FlightDate" type="displayDate" dataField="flightDate" align="center">
          </ngc-data-column>
          <ngc-data-column text="equipment.sta.std" type="displayTime" dataField="staOrstd" align="center">
          </ngc-data-column>
          <ngc-data-column text="equipment.towed.pd.br" dataField="towedPD" align="center"></ngc-data-column>
          <ngc-data-column text="equipment.released.user.br" dataField="releasedUser" align="center"></ngc-data-column>
          <ngc-data-column text="equipment.released.date.time.br" type="displayDateTime" dataField="released"
            align="center">
          </ngc-data-column>
          <ngc-data-column text="equipment.driver.id.br" dataField="driverID" align="center"></ngc-data-column>
          <ngc-data-column text="equipment.delivered.date.time.br" type="displayDateTime" dataField="delivered"
            align="center">
          </ngc-data-column>
          <ngc-data-column text="equipment.delivery.proof.br" type="displayTime" dataField="equipmentNumber"
            align="center">
            <ng-template let-name="name" let-group="group">
              <ng-container [formGroupName]="group">
                <ngc-photopreview entityType="shipment"
                  [entityKey]="searchReleaseReturnForm.get(['equipmentreleasereturndetail', group, 'releaseInfoID']).value"
                  associatedTo="2" stage="EQUIPMENT_DELIVERY" [showOnEmpty]="false"></ngc-photopreview>
              </ng-container>
            </ng-template>
          </ngc-data-column>
          <ngc-data-column text="equipment.receipt" dataField="uploadedDocId" align="center">
            <ng-template let-name="name" let-group="group">
              <ng-container
                *ngIf="searchReleaseReturnForm.get(['equipmentreleasereturndetail',group,'uploadedDocId']).value"
                [formGroupName]="group">
                <ngc-filedownload [uploadDocId]="searchReleaseReturnForm.get(['equipmentreleasereturndetail',group,'uploadedDocId']).value">
                </ngc-filedownload>
              </ng-container>
            </ng-template>
          </ngc-data-column>
          <ngc-data-column text="equipment.damage.proof.br" type="displayTime" dataField="damageProof" align="center">
            <ng-template let-name="name" let-group="group">
              <ng-container [formGroupName]="group">
                <ngc-photopreview entityType="shipment"
                  [entityKey]="searchReleaseReturnForm.get(['equipmentreleasereturndetail', group, 'damageProof']).value"
                  associatedTo="2" stage="EQUIPMENT_RETURN" [showOnEmpty]="false"></ngc-photopreview>
              </ng-container>
            </ng-template>
          </ngc-data-column>
          <ngc-data-column text="equipment.returned.by.br" dataField="returnedby" align="center"></ngc-data-column>
          <ngc-data-column text="equipment.returned.date.time.br" type="displayDateTime" dataField="returned"
            align="center">
          </ngc-data-column>
          <ngc-data-column text="equipment.dwell.time.br" dataField="dwellTime" align="center"></ngc-data-column>
          <ngc-data-column text="g.status" dataField="status" align="center"></ngc-data-column>
          <ngc-data-column text="equipment.force.return.br" dataField="forceReturn" align="center"></ngc-data-column>
          <ngc-data-column text="equipment.transport.indicator.br" dataField="transportIndicator" align-text="center">
          </ngc-data-column>
          <ngc-data-column text="equipment.request.number" dataField="requestTransactionNumber" align-text="center">
          </ngc-data-column>
          <ngc-data-column text="equipment.trip.number" dataField="transactionNumber" align-text="center">
          </ngc-data-column>
        </ngc-edittable>
      </ngc-column>
    </ngc-row>
  </ngc-container>
  <ngc-report  #reportWindow title="g.report"  reportId='ReleaseorReturn'  [reportParameters]='reportParameters'
    format='xls'></ngc-report>

  <ngc-window (close)="onClose()" #window [width]="700" [height]="150" title="equipment.request">
    <ngc-container type="tab">
      <ngc-row>
        <ngc-column>
          <ngc-label label="g.carrier"></ngc-label>
          <div>
            <ngc-dropdownlist accessEnableOn="r" formControlName="carrier"
              sourceId="Equipment$CarrEquipFulfillmentReport" [width]="140" required></ngc-dropdownlist>
          </div>
        </ngc-column>
        <ngc-column>
          <ngc-label label="equipment.requested.fromdate"></ngc-label>
          <div>
            <ngc-datetimeinput accessEnableOn="r" formControlName="requestedfromDate" [showCalendarButton]="true"
              placeHolder="g.fromDate" [showTimeButton]="false" required></ngc-datetimeinput>
          </div>
        </ngc-column>
        <ngc-column>
          <ngc-label label="equipment.requested.todate"></ngc-label>
          <div>
            <ngc-datetimeinput accessEnableOn="r" formControlName="requestedtoDate" [showCalendarButton]="true"
              placeHolder="g.toDate" [showTimeButton]="false"
              [min]="this.searchReleaseReturnForm.get('requestedfromDate').value" required></ngc-datetimeinput>
          </div>
        </ngc-column>
      </ngc-row>
    </ngc-container>
    <ngc-window-footer>
      <ngc-container type="tab">
        <ngc-row>
          <ngc-column>
            <ngc-button (click)="printsummaryfullfillment($event)" value='Print'></ngc-button>
          </ngc-column>
        </ngc-row>
      </ngc-container>
    </ngc-window-footer>
  </ngc-window>
  <ngc-report  #reportWindow1 title=" g.report" reportId='Request_fulfilment_summary_Required_Released'
     [reportParameters]='reportParameters' format='xls'></ngc-report>
</form>
<ngc-footer>
  <ngc-row>
    <ngc-column align="center">
      <ngc-button [disabled]="!enableForceButton" label="equipment.force.return" (click)="onForceReturn($event, index)">
      </ngc-button>
      <ngc-button [disabled]="!enableButton" label="equipment.return" (click)="onReturn($event,index)"></ngc-button>
    </ngc-column>
  </ngc-row>
</ngc-footer>