<form [formGroup]="cn46Form">
  <ngc-titlebar title='title.create.CN.46' (print)='onCN46ServiceReport($event,index)' (clear)="onClear($event)"
    (save)="onSave($event)"></ngc-titlebar>
  <ngc-container type="sectiontop">
    <ngc-row>
      <ngc-column column="2">
        <ngc-label label="g.flight"></ngc-label>
        <div>
          <ngc-flightkeyinput accessEnableOn="r" upperCase="true" formControlName="flightKey" [width]="190" required></ngc-flightkeyinput>
        </div>
      </ngc-column>
      <ngc-column column="2">
        <ngc-label label="g.date"></ngc-label>
        <div>
          <ngc-datetimeinput accessEnableOn="r" upperCase="true" formControlName="flightDate" (ngModelChange)="onFlightKey()"
            [onlyDate]="true" [width]="190" required></ngc-datetimeinput>
        </div>
      </ngc-column>
      <ngc-column column="2">
        <ngc-label label="flight.segment"></ngc-label>
        <div>
          <ngc-dropdownlist accessEnableOn="r" [width]="190" sourceId="CN46_SEGMENT" required (select)="selectSegmentId($event)"
            [sourceParameters]="flightKeyforDropdown" [noCache]="true" sourceType="query" [autoSelect]="true"
            formControlName="segment" placeHolder="Select"></ngc-dropdownlist>
        </div>
      </ngc-column>
      <ngc-column column="2">
        <ngc-label label="awb.store.location"></ngc-label>
        <div>
          <ngc-input accessEnableOn="r" upperCase="true" formControlName="trolleyNumber" [width]="190"></ngc-input>
        </div>
      </ngc-column>
      <ngc-column column="1">
        <ngc-label label="BULK"></ngc-label>
        <div>
          <ngc-checkbox accessEnableOn="r" formControlName="bulk" [width]="28"></ngc-checkbox>
        </div>
      </ngc-column>
      <ngc-column column="1">
        <ngc-label label=""></ngc-label>
        <div>
          <ngc-button accessEnableOn="r" value="cn46.search" (click)="onSearch($event,index)" iconType="search"></ngc-button>
        </div>
      </ngc-column>
      <ngc-column column="2">
        <ngc-label label=""></ngc-label>
        <div>
          <ngc-button accessEnableOn="r" value="g.print.report" (click)="onCN46ServiceReport($event,index)"></ngc-button>
        </div>
      </ngc-column>
    </ngc-row>
  </ngc-container>
  <ngc-container type="tab">
    <ngc-row>
      <ngc-column>
        <ngc-label label=""></ngc-label>
      </ngc-column>
    </ngc-row>
    <ngc-row>
      <ngc-column>
        <ngc-label label="mail.actual.conveyance"></ngc-label>
      </ngc-column>
    </ngc-row>
  </ngc-container>
  <ngc-container type="tab">
    <ngc-row>
      <ngc-column column="3">
        <ngc-label label="mail.observations.concerning.mail.found"></ngc-label>
        <ngc-input formControlName="observations" upperCase="true" [width]="280" required></ngc-input>
      </ngc-column>
      <ngc-column column="3">
        <ngc-label label="mail.administrations.of.origin"></ngc-label>
        <ngc-lov formControlName="adminOfOriginOfMails" required sourceId="FINAL_DESTINATION"
          title="mail.administrations.of.origin" dataField="code" [width]="230">
          <ngc-data-column text="flight.airportCode" dataField="code" [width]="30"></ngc-data-column>
        </ngc-lov>
      </ngc-column>
      <ngc-column column="2">
        <ngc-label label="flight.airport.of.loading"></ngc-label>
        <ngc-lov formControlName="airportOfLoading" required sourceId="FINAL_DESTINATION"
          title="flight.airport.of.loading" dataField="code" [width]="150">
          <ngc-data-column text="flight.airportCode" dataField="code" [width]="30"></ngc-data-column>
        </ngc-lov>
      </ngc-column>
      <ngc-column column="2">
        <ngc-label label="flight.airport.of.offloading"></ngc-label>
        <ngc-lov formControlName="airportOfOffLoading" required sourceId="FINAL_DESTINATION"
          title="flight.airport.of.offloading" dataField="code" [width]="150">
          <ngc-data-column text="flight.airportCode" dataField="code" [width]="30"></ngc-data-column>
        </ngc-lov>
      </ngc-column>
      <ngc-column column="2">
        <ngc-label label="mail.destination.office"></ngc-label>
        <ngc-input formControlName="destinationOffice" upperCase="true" [width]="150" required></ngc-input>
      </ngc-column>
    </ngc-row>
  </ngc-container>
  <ngc-container type="tab">
    <ngc-row>
      <ngc-column column="2">
        <ngc-label value="flight.outgoingflight"></ngc-label>
        <div>
          <ngc-flightkeyinput formControlName="outgoingFlightKey"></ngc-flightkeyinput>
        </div>
      </ngc-column>
      <ngc-column column="2">
        <ngc-label value="flight.outgoingflight.date"></ngc-label>
        <div>
          <ngc-datetimeinput formControlName="outgoingFlightDate" [onlyDate]="true"></ngc-datetimeinput>
        </div>
      </ngc-column>
    </ngc-row>
  </ngc-container>
  <ngc-container type="tab">
    <ngc-row>
      <ngc-column>
        <ngc-label label=""></ngc-label>
      </ngc-column>
    </ngc-row>
    <ngc-row>
      <ngc-column column="3">
        <ngc-label label="&nbsp"></ngc-label>
        <div>
          <ngc-label label="g.totalpieces" color="black"></ngc-label>: {{totalPieces}}
          <ngc-label label="g.totalweight" color="black"></ngc-label>: {{totalWeight}}
        </div>
      </ngc-column>
      <ngc-column column="7"></ngc-column>
      <ngc-column column="1">
        <ngc-button value="cn46.add" (click)="onAdd($event)"></ngc-button>
      </ngc-column>
      <ngc-column column="1">
        <ngc-button value="cn46.delete" (click)="onDelete($event)"></ngc-button>
      </ngc-column>
    </ngc-row>
    <ngc-row>
      <ngc-column>
        <ngc-table>
          <thead align="left">
            <tr>
              <th [width]="28">
                <ngc-icon type="yesno"></ngc-icon>
              </th>
              <th [width]="100">
                <ngc-label value="uld.Number"></ngc-label>
              </th>
              <th [width]="100">
                <ngc-label value="airmail.mailBagNumber"></ngc-label>
              </th>
              <th [width]="200">
                <ngc-label value="mail.office.of"></ngc-label>
            <tr>
              <th [width]="100">
                <ngc-label value="g.origin"></ngc-label>
              </th>
              <th [width]="100">
                <ngc-label value="g.destination"></ngc-label>
              </th>
            </tr>
            </th>
            <th [width]="200">
              <ngc-label value="flight.airport.of"></ngc-label>
              <tr>
                <th [width]="100">
                  <ngc-label value="g.transhipment"></ngc-label>
                </th>
                <th [width]="100">
                  <ngc-label value="g.offloading"></ngc-label>
                </th>
              </tr>
            </th>
            <th [width]="100">
              <ngc-label value="mail.date.of.dispatch"></ngc-label>
            </th>
            <th [width]="80">
              <ngc-label value="mail.letter.post"></ngc-label>
            </th>
            <th [width]="60">
              <ngc-label value="mail.cp"></ngc-label>
            </th>
            <th [width]="100">
              <ngc-label value="mail.ems"></ngc-label>
            </th>
            <th [width]="100">
              <ngc-label value="g.other.items"></ngc-label>
            </th>
            <th [width]="80">
              <ngc-label value="g.gross.weight"></ngc-label>
            </th>
            <th [width]="150">
              <ngc-label value="g.remarks"></ngc-label>
            </th>
            </tr>
          </thead>
          <tbody align="center" formArrayName="cn46Details">
            <tr *ngFor="let item of cn46Form.controls.cn46Details.controls; let index=index" [formGroupName]="index">
              <td>
                <ngc-checkbox formControlName="select" cellsAlign="center" [width]="28"></ngc-checkbox>
              </td>
              <td>
                <ngc-input formControlName="uldNumber" upperCase="true" [width]="100"></ngc-input>
              </td>
              <td>
                <ngc-input formControlName="mailNumber" required upperCase="true" [width]="100"></ngc-input>
              </td>
              <td>
            <tr>
              <td>
                <ngc-lov formControlName="originOfficeExchange" required sourceId="LOV_IMPC_POSTAL_AUTHORITY" title="g.origin"
                  dataField="code" [width]="45">
                  <ngc-data-column text="flight.airportCode" dataField="code" [width]="30"></ngc-data-column>
                </ngc-lov>
              </td>
              <td>
                <ngc-lov formControlName="destinationOfficeExchange" required sourceId="LOV_IMPC_POSTAL_AUTHORITY"
                  title="g.destination" dataField="code" [width]="45">
                  <ngc-data-column text="flight.airportCode" dataField="code" [width]="30"></ngc-data-column>
                </ngc-lov>
              </td>
            </tr>
            </td>
            <td>
              <tr>
                <td>
                  <ngc-lov formControlName="airportOfTranshipment" required sourceId="FINAL_DESTINATION"
                    title="awb.airport.of.transhipment" dataField="code" [width]="45">
                    <ngc-data-column text="flight.airportCode" dataField="code" [width]="30"></ngc-data-column>
                  </ngc-lov>
                </td>
                <td>
                  <ngc-lov formControlName="airportOfOffloading" required sourceId="FINAL_DESTINATION"
                    title="flight.airport.of.offloading" dataField="code" [width]="45">
                    <ngc-data-column text="flight.airportCode" dataField="code" [width]="30"></ngc-data-column>
                  </ngc-lov>
                </td>
              </tr>
            </td>
            <td>
              <ngc-datetimeinput formControlName="dateOfDispactch" required [width]="100"></ngc-datetimeinput>
            </td>
            <td>
              <ngc-numberinput decimalDigits="0"  formControlName="letterPost"  required [width]="80"></ngc-numberinput>
            </td>
            <td>
              <ngc-numberinput decimalDigits="0"  formControlName="cp"  required [width]="60"></ngc-numberinput>
            </td>
            <td>
              <ngc-numberinput decimalDigits="0"  formControlName="ems"  required [width]="60"></ngc-numberinput>
            </td>
            <td>
              <ngc-numberinput decimalDigits="0"  formControlName="otherItems"  required [width]="100">
              </ngc-numberinput>
            </td>
            <td>
              <ngc-weightinput formControlName="weight" required></ngc-weightinput>
            </td>
            <td>
              <ngc-input formControlName="remarks" upperCase="true" [width]="150"></ngc-input>
            </td>
            </tr>
          </tbody>
        </ngc-table>
      </ngc-column>
    </ngc-row>
  </ngc-container>
  <ngc-report #reportWindow title="g.report"  reportId='CN46'  [reportParameters]='reportParameters'></ngc-report>
</form>